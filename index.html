<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>RDG with Firebase</title>
</head>
<body>
  <!-- 省略你的拖拽排序代码、页面结构等 -->

  <!-- Firebase 脚本 -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore.js"></script>

  <script>
    // ===== 你的原始逻辑 =====
    let sites = [];
    function renderSites() { /* ... */ }
    function initSortable() { /* ... */ }
    function addSite() { /* ... */ }
    // ...

    // ===== Firebase 初始化 =====
    const firebaseConfig = {
      apiKey: "xxx",
      authDomain: "xxx.firebaseapp.com",
      projectId: "xxx",
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // ===== 从云端加载数据 =====
    async function loadDataFromCloud() {
      const docRef = db.collection("rdg").doc("sitesData");
      const docSnap = await docRef.get();
      if (docSnap.exists) {
        const data = docSnap.data();
        if (data.sites) {
          sites = data.sites;
        }
      }
      // 之后再渲染
      renderSites();
      initSortable();
    }

    // ===== 保存到云端 =====
    async function saveSites() {
      await db.collection("rdg").doc("sitesData").set({ sites });
      console.log("已保存到云端");
    }

    // ===== 页面初始化 =====
    loadDataFromCloud();
  </script>
</body>
</html>
